\section{Démarrage automatique d'un environnement de travail}

\subsection{Fonctionnalités attendues}

Ce procédé doit permettre aux développeur de Dynamease de pouvoir mettre en place de façon facile et rapide un environnement de travail complet permettant l'accès aux différents services de Dynamease. 

Il doit également être possible de pré-remplir les bases de données Dynamease, avec des données provenant de base de tests déjà utilisé ou bien d'une base de production.

L'outil ainsi créé devra pouvoir être utilisé aussi bien sur des serveurs que sur les machines locales des développeurs. 

\subsection{Étude du cahier des charges}

Les environnements utilisés par Dynamease peuvent tourner grâce à des container Docker. Pour l'outil qui sera développer, l'utilisation de ces containers sera mise en avant. Il sera donc nécessaire de déterminer l'ordre d'exécution de ces containers, en déterminant les différentes dépendance de ces containers.\\

Il faut également déterminer quels sont les meilleurs solutions pour la mise en place d'un système permettant l'intégration de données au démarrage de l'environnement Dynamease. L'environnement complet de Dynamease est constitué de plusieurs sous environnement, les différents environnement qui nécessitent d'un intégration de données sont :

\begin{itemize}
	\item La base de données MySQL;
	\item La base de données Ldap;
	\item La base de données liée à Aerogear;
	\item Les fichiers de configuration du serveur Dynamease.
\end{itemize}

Il faudra donc déterminer, pour chacun de ces environnement, quels sont les techniques permettant une intégration de données.

De plus il doit être possible de démarrer d'un environnement vide, il faudra donc gérer ce cas de figure, en initialisant les bases de données de manière à ce qu'elles soient utilisable dans l'environnement complet de Dynamease.

\subsection{Réalisation de l'outil}

\subsubsection{Détermination des dépendances}

[Mettre Diagramme pyramide]

Nous allons étudier le diagramme ci-dessus, de manière descendante. Tout en haut nous avons l'environnement Nginx, celui-ci nécessite la mise en place des environnements Tomcat et Aerogear pour fonctionner. L'environnement Tomcat aura besoin des bases de données MySQL et Ldap. 

Donc il nous faudra lancer l'environnement l'ordre suivant :

\begin{enumerate}
	\item La base de données MySQL;
	\item La base de données Ldap;
	\item Aerogear;
	\item Tomcat;
	\item Nginx.
\end{enumerate}

\subsubsection{Utilisation et Récupération des données}

On peut séparer les données à récupérer en deux catégories. Celles qui dépendent du système et celles qui n'en dépendent pas. Les données récupérer par le serveur Dynamease sont essentiellement des données de configuration. Cette configuration permet à Dynamease de connaître les adresse internet des différents services nécessaire à son fonctionnement. Ces adresses pouvant changer selon l'emplacement de démarrage de l'application Dynamease, les valeurs de ces configurations ne peuvent être prédites à l'avance. De plus le contenu des autres bases de données n'influe pas sur les valeurs de cette configuration, donc il s'agit bien là de données dépendant uniquement du système. 

Donc pour ce type de données, une variable d'environnement devra être créée par l'utilisateur afin de lui permettre de signifier à l'outil, où se situe les fichiers de configuration de Dynamease.\\

En ce qui concerne les autres données, celle-ci peuvent être stockées de la même manière. Seul leur intégration serra différente.

Deux solutions de stockage peuvent être étudiés, on pourrait utiliser les volumes de chaque containers, en intégrant les données. Cette méthode risque d'être assez limité sachant que chaque utilisateur devra disposer des fichiers de données afin de les intégrer dans son environnement. La seconde solution serait d'utiliser une nouvelle image Docker qui aura pour rôle le stockage de tout les fichiers de données. Cette solution permettrait de pouvoir utiliser n'importe quelle base de donné sans récupérer les fichiers de données. C'est cette seconde solution que nous allons développer par la suite.

Cette solution prend en compte que le container de données contienne des volumes pour stocker les fichiers de données. Or, comme nous l'avons vu précédemment, les volumes créés des liens symboliques depuis les volumes du container vers les répertoires situés sur la machine faisant tourner le container. Donc le container serait opérationnel uniquement sur la machine l'ayant créé, si ce container se trouve sur un autre système, il se peut que les liens ne pointes sur aucuns fichiers ou sur de mauvais fichiers. 

On a également vu qu'on pouvait exécuter des commandes lors de la création du container. L'idée est d'utiliser un script de démarrage du container, qui nous servira à déplacer et trier les fichiers de données vers de nouveaux répertoires.

Grâce à cette récupération nous pouvons maintenant faire un traitement pour chaque fichier selon le type de base de données où celui-ci doit être inclue.\\

Il est aussi prévu de permettre aux utilisateurs de cet outil de lancer un environnement de travail, vide. C'est à dire seulement avec les bases de données initialisées, mais sans données.